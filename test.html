function fn_get_psk_rur(p_account_number number) return number as
    psk_total_sum number;
    ins_summ number;
  begin
    select sum(int_due)
      into psk_total_sum
    from CASHFLOW_F_TEMP_TAB;    
    dbms_output.put_line('total psk summ: ' || psk_total_sum);
    
    select sum(emi_amount)
      into ins_summ
    from CASHFLOW_F_TEMP_TAB
    where rn=0;    
    dbms_output.put_line('ins_summ: ' || ins_summ);
    
    IF ins_summ > 0 THEN
      psk_total_sum := psk_total_sum + ins_summ;
      dbms_output.put_line('total psk summ: ' || psk_total_sum);
    END IF;

    return psk_total_sum;
    EXCEPTION
      WHEN others THEN return -1;
  end;
