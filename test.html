FUNCTION Calc_amount_for_period ( p_account_number varchar2
                                    , start_date date
                                    , end_date date
                                    , p_sum number
                                    , p_component varchar2) return number is
        int_ovd_p           number          :=0;
        v_start             date            := start_date;
        v_days_in_year      number;
        v_daily_amount      number          := 0;
        v_int_ovd_p_sum     number          := 0;
        v_current_rate      number;
        v_value_date        date            := v_start + 1;
        v_rate_type         varchar2(20)    := 'ANNUAL';

        debug_row           Calc_amount_for_period_tab%rowtype;
    begin
         -- dbms_output.put_line('********************************************');
         -- dbms_output.put_line('p_component' || p_component);
        IF p_component = 'PENALTY_RATE' THEN
            v_rate_type := rate_type(p_account_number);
        END IF;

        if v_start < end_date then
            while v_value_date <= end_date loop
                v_current_rate := get_current_rate(p_account_number, v_value_date, p_component);



                IF v_rate_type = 'ANNUAL' THEN
                    v_days_in_year := lh_rep2361_v6.GET_DAYS_IN_YEAR(v_value_date);
                    v_daily_amount := p_sum * v_current_rate/100/v_days_in_year;
                ELSE
                    v_daily_amount := p_sum * v_current_rate/100;
                END IF;

                v_int_ovd_p_sum := v_int_ovd_p_sum + v_daily_amount;

                -- *************************  debug start ************************* --
                EXECUTE IMMEDIATE 'TRUNCATE TABLE Calc_amount_for_period_tab'
                debug_row.account_number := p_account_number;
                debug_row.value_date     := v_value_date;
                debug_row.basis          := p_sum;
                debug_row.daily_sum      := v_daily_amount;
                debug_row.final_sum      := v_int_ovd_p_sum;

                INSERT INTO Calc_amount_for_period_tab VALUES debug_row;

--                dbms_output.put_line('Дата начисления: ' || v_value_date);
--                dbms_output.put_line('Текущая ставка: ' || v_current_rate);
--                dbms_output.put_line('Базис для начисления: ' || p_sum);
--                dbms_output.put_line('Сумма дневного начисления: ' || v_daily_amount);
--                dbms_output.put_line('Итого: ' || v_int_ovd_p_sum);
                -- *************************  debug end ************************* --
                v_value_date := v_value_date + 1;
            end loop;
            COMMIT;
        end if;
        return round(v_int_ovd_p_sum, 2);
    exception
        when others then
            dbms_output.put_line('TEXT: '||SQLERRM);
            dbms_output.put_line('ERROR HAPPENED get_dayly_penalty: '||p_account_number);
    end;
