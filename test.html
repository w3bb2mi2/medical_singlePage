prompt recompile invalids
DECLARE
  n        NUMBER := 0;
  invalids NUMBER := 999;
BEGIN
  WHILE invalids > 0 AND n <= 3
  LOOP
    sys.utl_recomp.recomp_parallel(threads => 4);
    SELECT COUNT(*)
      INTO invalids
      FROM all_objects
     WHERE status <> 'VALID'
       AND owner NOT LIKE 'MB%'
       AND owner NOT LIKE 'BTD%'
       AND NOT regexp_like(owner, '^ER\d*$')
       AND NOT (owner IN ('FCCREP', 'BODEV', 'BORONLY') AND ora_database_name IN ('FCC07.IMB.RU',
                                                                                  'FCC02.IMB.RU',
                                                                                  'FCC03.IMB.RU',
                                                                                  'FCC04.IMB.RU',
                                                                                  'FCC05.IMB.RU',
                                                                                  'FCC06.IMB.RU',
                                                                                  'FCC08.IMB.RU',
                                                                                  'FCC09.IMB.RU',
                                                                                  'FCC10.IMB.RU',
                                                                                  'FCC13.IMB.RU',
                                                                                  'FCC20.IMB.RU',
                                                                                  'FCC21.IMB.RU'));
    n := n + 1;
  END LOOP;
END;
/

prompt Check number of invalid objects. Is it 0 ?
select owner, count(*) invalids from all_objects where status<>'VALID' group by owner;


DECLARE
  invalid_qty NUMBER;
BEGIN
  SELECT COUNT(*)
    INTO invalid_qty
    FROM all_objects
   WHERE status <> 'VALID'
     AND owner NOT LIKE 'MB%'
     AND owner NOT LIKE 'BTD%'
     AND NOT REGEXP_LIKE(owner, '^ER\d*$')
     AND NOT (owner IN ('FCCREP', 'BODEV', 'BORONLY') AND
          ora_database_name IN ('FCC07.IMB.RU', 'FCC02.IMB.RU', 'FCC03.IMB.RU', 'FCC04.IMB.RU', 'FCC05.IMB.RU', 'FCC06.IMB.RU', 'FCC08.IMB.RU', 'FCC09.IMB.RU', 'FCC10.IMB.RU', 'FCC13.IMB.RU', 'FCC20.IMB.RU', 'FCC21.IMB.RU'));

  IF invalid_qty <> 0
  THEN
    raise_application_error(-20101, 'Invalid objects found');
  END IF;

EXCEPTION
  WHEN no_data_found THEN
    NULL;
END;
/
